"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const S3_1 = require("./S3");
describe("endpoint", () => {
    it("users can override endpoint from client.", async () => {
        //use s3 here but all the clients are generated similarly
        const endpointValidator = next => args => {
            // middleware intercept the request and return it early
            const request = args.request;
            expect(request.protocol).toEqual("http:");
            expect(request.hostname).toEqual("localhost");
            expect(request.port).toEqual(8080);
            //query and path should not be overwritten
            expect(request.query).not.toContainEqual({ foo: "bar" });
            expect(request.path).not.toEqual("/path");
            return Promise.resolve({ output: {}, response: {} });
        };
        const client = new S3_1.S3({ endpoint: "http://localhost:8080/path?foo=bar" });
        client.middlewareStack.add(endpointValidator, {
            step: "serialize",
            name: "endpointValidator",
            priority: "low"
        });
        await client.putObject({ Bucket: "bucket", Key: "key", Body: "body" });
    });
});
//# sourceMappingURL=S3.spec.js.map